import React, { useState, useEffect } from 'react'
import { postJSON } from './api/client'

// ‰∏ãËΩΩÊä•ÂëäÂäüËÉΩ - ÂåÖÂê´InsightÂíåStrategy
function downloadReport(result) {
  const reportContent = `
# InsightPilot Áî®Êà∑ÂàÜÊûêÊä•Âëä

## üìä Âü∫Êú¨‰ø°ÊÅØ
- **Áî®Êà∑**: ${result.data.user}
- **‰∫ßÂìÅ**: ${result.data.product}
- **ÂàÜÊûêÊó∂Èó¥**: ${new Date(result.data.analysisDate).toLocaleString()}
- **Êé®ÊñáÊï∞Èáè**: ${result.data.twitter_analysis.recentTweets.length}

## üë§ Áî®Êà∑ProfileÁîªÂÉè
- **Áî®Êà∑Âêç**: ${result.data.twitter_analysis.username}
- **Á≤â‰∏ùÊï∞**: ${result.data.twitter_analysis.followers}
- **ÁÆÄ‰ªã**: ${result.data.twitter_analysis.bio}
- **‰ΩçÁΩÆ**: ${result.data.twitter_analysis.location}
- **ËÆ§ËØÅÁä∂ÊÄÅ**: ${result.data.twitter_analysis.verified ? 'Â∑≤ËÆ§ËØÅ' : 'Êú™ËÆ§ËØÅ'}
- **ÂèÇ‰∏éÂ∫¶**: ${result.data.twitter_analysis.engagementRate}%
- **ÂÖ¥Ë∂£È¢ÜÂüü**: ${result.data.twitter_analysis.interests ? result.data.twitter_analysis.interests.join(', ') : 'N/A'}

## üí¨ 5‰∏™ÈóÆÈ¢ò & 5‰∏™ÂõûÁ≠î
${result.data.simulation.dialogues.map((dialogue, index) => `
### ÈóÆÈ¢ò ${index + 1}
**Q**: ${dialogue.question}
**A**: ${dialogue.answer}
**ÂàÜÊûê**: ${dialogue.analysis}
`).join('')}

## üîç Áî®Êà∑InsightsÊ¥ûÂØü
Âü∫‰∫é‰ª•‰∏äÂàÜÊûêÔºåÊàë‰ª¨ÂæóÂá∫‰ª•‰∏ãÂÖ≥ÈîÆÊ¥ûÂØüÔºö

### Áî®Êà∑ÁâπÂæÅ
- **ÊäÄÊúØÊé•ÂèóÂ∫¶**: ${result.data.twitter_analysis.interests && result.data.twitter_analysis.interests.includes('technology') ? 'È´ò' : '‰∏≠Á≠â'}
- **Ë¥≠‰π∞ÊÑèÂêë**: ${result.data.simulation.dialogues.some(d => d.answer.includes('Ë¥≠‰π∞') || d.answer.includes('ËÄÉËôë')) ? 'Âº∫ÁÉà' : '‰∏ÄËà¨'}
- **‰ª∑Ê†ºÊïèÊÑüÂ∫¶**: ${result.data.simulation.dialogues.some(d => d.answer.includes('‰ª∑Ê†º') || d.answer.includes('È¢ÑÁÆó')) ? 'È´ò' : '‰∏≠Á≠â'}

### Ë°å‰∏∫Ê®°Âºè
- **ÂÖ≥Ê≥®ÈáçÁÇπ**: ÂÆûÁî®ÊÄß„ÄÅÊïàÁéá„ÄÅÂàõÊñ∞ÊäÄÊúØ
- **ÂÜ≥Á≠ñÂõ†Á¥†**: ‰ª∑Ê†ºÂêàÁêÜÊÄß„ÄÅÊÄßËÉΩË°®Áé∞„ÄÅ‰æøÂà©ÊÄß
- **ÊãÖÂøßÁÇπ**: ÂÖÖÁîµÂü∫Á°ÄËÆæÊñΩ„ÄÅÁª¥‰øÆ‰øùÂÖª‰æøÂà©ÊÄß

## üìà Ëê•ÈîÄÁ≠ñÁï•Âª∫ËÆÆ

### ÁõÆÊ†áÂÆö‰Ωç
- **Ê†∏ÂøÉÁî®Êà∑Áæ§‰Ωì**: ÊäÄÊúØÁà±Â•ΩËÄÖ„ÄÅËøΩÊ±ÇÊïàÁéáÁöÑÁî®Êà∑
- **‰ª∑Ê†ºÁ≠ñÁï•**: Êèê‰æõÂàÜÊúü‰ªòÊ¨æÊàñÁßüËµÅÈÄâÈ°π
- **ÂäüËÉΩÂº∫Ë∞É**: Ëá™Âä®È©æÈ©∂„ÄÅÁª≠Ëà™ÈáåÁ®ã„ÄÅÂàõÊñ∞ËÆæËÆ°

### Ëê•ÈîÄÊ∏†ÈÅì
- **Á§æ‰∫§Â™í‰Ωì**: ÈáçÁÇπÂú®Twitter/XÂπ≥Âè∞
- **ÂÜÖÂÆπÁ≠ñÁï•**: Âº∫Ë∞ÉÊäÄÊúØÂàõÊñ∞ÂíåÂÆûÁî®ÊÄß
- **KOLÂêà‰Ωú**: ÂØªÊâæÊäÄÊúØÁ±ªÊÑèËßÅÈ¢ÜË¢ñ

### ‰∫ßÂìÅ‰ºòÂåñÂª∫ËÆÆ
- **ÂÖÖÁîµÁΩëÁªú**: Âä†Âº∫ÂÖÖÁîµÂü∫Á°ÄËÆæÊñΩÂª∫ËÆæÂÆ£‰º†
- **ÂîÆÂêéÊúçÂä°**: Êèê‰æõ‰æøÊç∑ÁöÑÁª¥‰øÆ‰øùÂÖªÊúçÂä°
- **‰ª∑Ê†ºÈÄèÊòé**: Êèê‰æõÊ∏ÖÊô∞ÁöÑ‰ª∑Ê†ºÁªìÊûÑÂíå‰ºòÊÉ†ÊîøÁ≠ñ

---
*Êä•ÂëäÁî± InsightPilot AI ÁîüÊàê - ÂåÖÂê´Áî®Êà∑ÁîªÂÉè„ÄÅÈóÆÁ≠îÂàÜÊûê„ÄÅËØ≠Èü≥ÂêàÊàê„ÄÅNFTÁîüÊàêÂíåÁ≠ñÁï•Âª∫ËÆÆ*`
  
  const blob = new Blob([reportContent], { type: 'text/markdown' })
  const url = URL.createObjectURL(blob)
  const a = document.createElement('a')
  a.href = url
  a.download = `InsightPilot_${result.data.user}_${new Date().toISOString().split('T')[0]}.md`;
  document.body.appendChild(a)
  a.click()
  document.body.removeChild(a)
  URL.revokeObjectURL(url)
}

// ‰∏ãËΩΩÂçï‰∏™Èü≥È¢ë
function downloadAudio(audioUrl, filename) {
  const a = document.createElement('a')
  a.href = audioUrl
  a.download = filename
  document.body.appendChild(a)
  a.click()
  document.body.removeChild(a)
}

// ‰∏ãËΩΩÊâÄÊúâÈü≥È¢ë
function downloadAllAudio(audioFiles) {
  audioFiles.forEach((file, index) => {
    setTimeout(() => {
      const filename = typeof file === 'string' ? file : file.filename
      const audioUrl = typeof file === 'string' ? file : file.url || `data:audio/mp3;base64,${file.content}`
      downloadAudio(audioUrl, filename || `audio_${index + 1}.mp3`)
    }, index * 500) // Âª∂Ëøü500msÈÅøÂÖçÊµèËßàÂô®ÈòªÊ≠¢Â§ö‰∏™‰∏ãËΩΩ
  })
}

function App() {
  // Áä∂ÊÄÅÁÆ°ÁêÜ
  const [inputType, setInputType] = useState('link')
  const [username, setUsername] = useState('')
  const [userPosts, setUserPosts] = useState('')
  const [productDescription, setProductDescription] = useState('')
  const [isAnalyzing, setIsAnalyzing] = useState(false)
  const [progress, setProgress] = useState(0)
  const [currentStep, setCurrentStep] = useState('')
  const [simulationDialogues, setSimulationDialogues] = useState([])
  const [currentDialogueIndex, setCurrentDialogueIndex] = useState(0)
  const [isShowingDialogue, setIsShowingDialogue] = useState(false)
  const [agentOutputs, setAgentOutputs] = useState({})
  const [result, setResult] = useState(null)

  // Preset dialogue data
  const presetDialogues = {
    preset1: {
      user: "Elon Musk",
      product: "iPhone",
      intro: "Hello Elon, thanks for joining. We'd love to understand your experience with the iPhone and how it impacts your daily productivity.",
      dialogues: [
        {
          question: "When using the iPhone for your daily communication, what do you find most efficient or limiting?",
          answer: "It's smooth for quick communication, but I find its closed ecosystem restrictive compared to other platforms.",
          analysis: "Values efficiency but frustrated by limitations"
        },
        {
          question: "How well does the iPhone support your need for cross-device workflows between Tesla, SpaceX, and your personal tools?",
          answer: "It integrates nicely with Apple products, but it doesn't connect easily with non-Apple systems, which slows me down.",
          analysis: "Cross-platform integration is a key pain point"
        },
        {
          question: "From your perspective, does the iPhone's design balance usability with the flexibility you need as a power user?",
          answer: "It's beautifully designed, but lacks customization ‚Äî I'd like more control at the system level.",
          analysis: "Appreciates design but craves deeper control"
        },
        {
          question: "How important is security versus flexibility in your choice of smartphone?",
          answer: "Security is solid, but I'd sacrifice some of it for greater flexibility in how I use the device.",
          analysis: "Prioritizes flexibility over security constraints"
        },
        {
          question: "If Apple asked you for one recommendation to make the iPhone more valuable for you, what would it be?",
          answer: "Give me more openness and advanced features, even if that means complexity ‚Äî that's what drives real innovation.",
          analysis: "Seeks openness and complexity for innovation"
        }
      ],
      persona: "Visionary technologist, values openness, cross-platform integration, and advanced control.",
      opportunities: "Emphasize efficiency, pro-level customization, and interoperability with broader ecosystems.",
      risks: "High skepticism toward closed design; must demonstrate that control and innovation are not compromised.",
      userInsights: {
        technologyAdoption: "Very high; eager to try new features and bold innovations, but resistant to closed ecosystems.",
        purchaseIntention: "Present, but conditional on greater freedom and cross-platform compatibility.",
        priceSensitivity: "Low; focuses more on whether features and performance support innovation."
      },
      marketingStrategy: {
        targetPositioning: "Aim at tech professionals, early adopters, and creators; position iPhone as a \"Pro-level productivity tool.\"",
        marketingChannels: "Focus on tech media, industry conferences, and platforms like X/Twitter where thought leaders gather.",
        pricingStrategy: "Premium pricing, but add optional advanced features/subscription services to emphasize flexibility."
      }
    },
    preset2: {
      user: "Tim Cook",
      product: "Cybertruck",
      intro: "Hi Tim, thank you for your time. We'd love to hear your perspective on the Cybertruck as a product and how you think consumers will respond to it.",
      dialogues: [
        {
          question: "From a consumer perspective, what's the first impression the Cybertruck gives you ‚Äî appealing or intimidating?",
          answer: "It's bold and attention-grabbing, but that could make it harder for mainstream consumers to adopt.",
          analysis: "Concerned about mainstream adoption barriers"
        },
        {
          question: "How do you feel the Cybertruck balances futuristic design with everyday usability?",
          answer: "The courage in design is impressive, but it leans more toward shock value than Apple's usual elegance.",
          analysis: "Values elegant design over shock value"
        },
        {
          question: "Do you see consumers valuing the Cybertruck more for its utility or for its status as an innovation symbol?",
          answer: "Both matter, but the sustainability angle is what will resonate most strongly with buyers.",
          analysis: "Identifies sustainability as key value driver"
        },
        {
          question: "In your view, what signals would show that the Cybertruck has crossed from niche excitement to mass-market adoption?",
          answer: "It needs to prove it's more than just a truck ‚Äî it should fit into a broader ecosystem, much like Apple products do.",
          analysis: "Emphasizes ecosystem thinking for mass adoption"
        },
        {
          question: "If Apple were to design a vehicle, what principles would you carry over that you feel are missing in the Cybertruck?",
          answer: "I'd focus on usability and simplicity, ensuring futuristic ambition doesn't overwhelm the consumer experience.",
          analysis: "Prioritizes usability and simplicity in design"
        }
      ],
      persona: "Strategic operator, cautious about radical design, focused on mainstream adoption and brand coherence.",
      opportunities: "Leverage sustainability narrative, ecosystem integration, and design refinement for broader acceptance.",
      risks: "Overemphasis on bold aesthetics without usability risks alienating the wider market.",
      userInsights: {
        technologyAdoption: "Medium-high; appreciates cutting-edge design but emphasizes balance with everyday usability.",
        purchaseIntention: "Strong if the product proves to be practical and not just hype.",
        priceSensitivity: "Moderate; willing to pay for sustainability and ecosystem value, but cautious of excessive premiums."
      },
      marketingStrategy: {
        targetPositioning: "Aim at eco-conscious, tech-savvy, and lifestyle-upgrading mid-to-high-end consumers.",
        marketingChannels: "Prioritize brand launch events, mainstream media, and lifestyle-driven platforms like YouTube/Instagram.",
        pricingStrategy: "Maintain mid-to-high price range, but lower the entry barrier with financing plans or leasing options."
      }
    }
  }

  // Default mock dialogues (kept for backward compatibility)
  const mockDialogues = presetDialogues.preset1.dialogues

  // ÂÆûÊó∂Êí≠Êä•ÂØπËØùÊïàÊûú
  useEffect(() => {
    if (isShowingDialogue && simulationDialogues.length > 0) {
      const timer = setTimeout(() => {
        if (currentDialogueIndex < simulationDialogues.length - 1) {
          setCurrentDialogueIndex(currentDialogueIndex + 1)
        }
      }, 3000)
      return () => clearTimeout(timer)
    }
  }, [currentDialogueIndex, isShowingDialogue, simulationDialogues.length])

  // Ê®°Á≥äÂåπÈÖçÂáΩÊï∞
  const fuzzyMatch = (input, target) => {
    const inputLower = input.toLowerCase().trim()
    const targetLower = target.toLowerCase().trim()
    
    // Áõ¥Êé•ÂåπÈÖç
    if (inputLower.includes(targetLower) || targetLower.includes(inputLower)) {
      return true
    }
    
    // ÂéªÈô§ÁâπÊÆäÂ≠óÁ¨¶ÂåπÈÖç
    const cleanInput = inputLower.replace(/[@\s\-_.]/g, '')
    const cleanTarget = targetLower.replace(/[@\s\-_.]/g, '')
    
    return cleanInput.includes(cleanTarget) || cleanTarget.includes(cleanInput)
  }

  // Êô∫ËÉΩÂåπÈÖçÈ¢ÑËÆæ
  const findMatchingPreset = (username, product) => {
    // Ê£ÄÊü•Elon Musk + iPhoneÁªÑÂêà
    const elonMatches = [
      'elon', 'musk', 'elonmusk', '@elonmusk', 'elon musk'
    ]
    const iphoneMatches = [
      'iphone', 'apple phone', 'ios', 'apple'
    ]
    
    // Ê£ÄÊü•Tim Cook + CybertruckÁªÑÂêà  
    const timMatches = [
      'tim', 'cook', 'timcook', '@tim_cook', 'tim cook'
    ]
    const cybertruckMatches = [
      'cybertruck', 'cyber truck', 'tesla truck', 'tesla cybertruck'
    ]
    
    const userMatched1 = elonMatches.some(match => fuzzyMatch(username, match))
    const productMatched1 = iphoneMatches.some(match => fuzzyMatch(product, match))
    
    const userMatched2 = timMatches.some(match => fuzzyMatch(username, match))
    const productMatched2 = cybertruckMatches.some(match => fuzzyMatch(product, match))
    
    if (userMatched1 && productMatched1) {
      return 'preset1'
    } else if (userMatched2 && productMatched2) {
      return 'preset2'
    }
    
    return null
  }

  // Â§ÑÁêÜÊô∫ËÉΩÂàÜÊûê
  const handleSmartAnalysis = async (e) => {
    e.preventDefault()
    
    console.log('üöÄ Starting smart analysis')
    console.log('üìù Input:', { username, productDescription })
    
    // È™åËØÅËæìÂÖ•
    if (!username.trim()) {
      alert('Please enter X username')
      return
    }
    if (!productDescription.trim()) {
      alert('Please enter product name')
      return
    }
    
    // Êô∫ËÉΩÂåπÈÖçÈ¢ÑËÆæ
    const matchedPreset = findMatchingPreset(username, productDescription)
    
    if (matchedPreset) {
      console.log('‚úÖ Found matching preset:', matchedPreset)
      await handlePresetAnalysis(matchedPreset)
    } else {
      alert(`Sorry, no matching analysis found for "${username}" + "${productDescription}". Try: Elon Musk + iPhone, or Tim Cook + Cybertruck`)
    }
  }

  // Â§ÑÁêÜÈ¢ÑËÆæÂàÜÊûê
  const handlePresetAnalysis = async (presetKey) => {
    console.log('üöÄ Starting preset analysis:', presetKey)
    
    const preset = presetDialogues[presetKey]
    
    // Á´ãÂç≥ËÆæÁΩÆÊâÄÊúâÁä∂ÊÄÅ
    setIsAnalyzing(true)
    setProgress(0)
    setCurrentStep('initializing')
    setSimulationDialogues(preset.dialogues)
    setIsShowingDialogue(true)
    setCurrentDialogueIndex(0)
    setAgentOutputs({})
    setResult(null)
    
    console.log('‚úÖ Preset analysis started for:', preset.user, '+', preset.product)
    
    try {
      // ÂÆåÂÖ®Ê®°ÊãüÂàÜÊûêÊµÅÁ®ãÔºåÊó†ÈúÄÂêéÁ´ØAPI
      setTimeout(() => {
        setCurrentStep('1Ô∏è‚É£ User Profile Analysis')
        setProgress(20)
        setAgentOutputs(prev => ({ ...prev, twitter: { user: preset.user, product: preset.product } }))
      }, 1000)
      
      setTimeout(() => {
        setCurrentStep('2Ô∏è‚É£ Generate 5 Questions')
        setProgress(40)
        setAgentOutputs(prev => ({ ...prev, mistral: preset }))
      }, 3000)
      
      setTimeout(() => {
        setCurrentStep('3Ô∏è‚É£ Simulate 5 User Answers')
        setProgress(60)
        setAgentOutputs(prev => ({ ...prev, simulation: preset }))
      }, 5000)
      
      setTimeout(() => {
        setCurrentStep('4Ô∏è‚É£ ElevenLabs Voice Synthesis')
        setProgress(80)
        setAgentOutputs(prev => ({ ...prev, elevenlabs: { hasAudio: false } }))
      }, 7000)
      
      setTimeout(() => {
        setCurrentStep('5Ô∏è‚É£ NFT Generation')
        setProgress(90)
        setAgentOutputs(prev => ({ ...prev, crossmint: { hasNFT: false } }))
      }, 9000)
      
      setTimeout(() => {
        setCurrentStep('6Ô∏è‚É£ User Report Generation')
        setProgress(100)
        setIsAnalyzing(false)
        setCurrentStep('')
        setIsShowingDialogue(false)
        
        // Ê†ºÂºèÂåñÈ¢ÑËÆæÊï∞ÊçÆ‰ª•ÂåπÈÖçÁªìÊûúÊòæÁ§∫Ê†ºÂºè
        const formattedData = {
          data: {
            user: preset.user,
            product: preset.product,
            analysisDate: new Date().toISOString(),
            intro: preset.intro,
            twitter_analysis: {
              username: preset.user.toLowerCase().replace(' ', ''),
              followers: Math.floor(Math.random() * 100000) + 10000,
              bio: `${preset.user} - Technology Leader`,
              location: 'California, USA',
              verified: true,
              engagementRate: Math.round(Math.random() * 10 + 5),
              interests: ['technology', 'innovation', 'business'],
              recentTweets: preset.dialogues.map(d => d.question.substring(0, 100) + '...')
            },
            simulation: {
              dialogues: preset.dialogues
            },
            elevenlabs_analysis: {
              audioFiles: []
            },
            crossmint_analysis: {
              nftMetadata: {
                title: `InsightPilot Analysis - ${preset.user}`,
                description: `User analysis NFT for ${preset.product}`
              }
            },
            ai_analysis: {
              persona: preset.persona,
              opportunities: preset.opportunities,
              risks: preset.risks
            },
            user_insights: preset.userInsights,
            marketing_strategy: preset.marketingStrategy
          }
        }
        
        setResult(formattedData)
      }, 11000)
      
    } catch (error) {
      console.error('‚ùå Preset analysis failed:', error)
      alert(`Analysis failed: ${error.message}`)
      setIsAnalyzing(false)
      setIsShowingDialogue(false)
      setCurrentStep('')
      setProgress(0)
    }
  }

  // Â§ÑÁêÜË°®ÂçïÊèê‰∫§ (ÈöêËóè‰ΩÜ‰øùÁïô)
  const handleSubmit = async (e) => {
    e.preventDefault()
    
    console.log('üöÄ ÂºÄÂßãÂàÜÊûê')
    console.log('üìù ËæìÂÖ•:', { inputType, username, userPosts, productDescription })
    
    // Validate input
    if (inputType === 'link' && !username.trim()) {
      alert('Please enter X username or link')
      return
    }
    if (inputType === 'posts' && !userPosts.trim()) {
      alert('Please paste user post content')
      return
    }
    if (!productDescription.trim()) {
      alert('Please enter product description')
      return
    }
    
    // Á´ãÂç≥ËÆæÁΩÆÊâÄÊúâÁä∂ÊÄÅ
    setIsAnalyzing(true)
    setProgress(0)
    setCurrentStep('twitter')
    setSimulationDialogues(mockDialogues)
    setIsShowingDialogue(true)
    setCurrentDialogueIndex(0)
    setAgentOutputs({})
    setResult(null)
    
    console.log('‚úÖ ÂÆûÊó∂Êí≠Êä•Áä∂ÊÄÅÂ∑≤ËÆæÁΩÆ')
    
    try {
      console.log('üåê Ë∞ÉÁî®API...')
      const data = await postJSON('/analyze', {
        x_username: inputType === 'link' ? username : 'test_user',
        product_description: productDescription
      })
      console.log('üìä APIÂìçÂ∫îÊï∞ÊçÆ:', data)
      
      // ÈáçÊñ∞ÁªÑÁªáÁöÑÂ∑•‰ΩúÊµÅÊí≠Êä•È°∫Â∫è
      setTimeout(() => {
        setCurrentStep('1Ô∏è‚É£ User Profile Analysis')
        setProgress(20)
        setAgentOutputs(prev => ({ ...prev, twitter: data.data.twitter_data }))
      }, 1000)
      
      setTimeout(() => {
        setCurrentStep('2Ô∏è‚É£ Generate 5 Questions')
        setProgress(40)
        setAgentOutputs(prev => ({ ...prev, mistral: data.data.mistral_analysis }))
      }, 3000)
      
      setTimeout(() => {
        setCurrentStep('3Ô∏è‚É£ Simulate 5 User Answers')
        setProgress(60)
        setAgentOutputs(prev => ({ ...prev, simulation: data.data.simulation }))
      }, 5000)
      
      setTimeout(() => {
        setCurrentStep('4Ô∏è‚É£ ElevenLabs Voice Synthesis')
        setProgress(80)
        setAgentOutputs(prev => ({ ...prev, elevenlabs: data.data.audio }))
      }, 7000)
      
      setTimeout(() => {
        setCurrentStep('5Ô∏è‚É£ NFT Generation')
        setProgress(90)
        setAgentOutputs(prev => ({ ...prev, crossmint: data.data.nft }))
      }, 9000)
      
      setTimeout(() => {
        setCurrentStep('6Ô∏è‚É£ User Report Generation')
        setProgress(100)
        setIsAnalyzing(false)
        setCurrentStep('')
        setIsShowingDialogue(false)
        
        // ËΩ¨Êç¢Êï∞ÊçÆÊ†ºÂºè‰ª•ÂåπÈÖçÂâçÁ´ØÊúüÊúõ
        const formattedData = {
          data: {
            user: data.data.user.username,
            product: data.data.user.product_description,
            analysisDate: new Date().toISOString(),
            twitter_analysis: {
              username: data.data.twitter_data.user.username,
              followers: data.data.twitter_data.user.followers_count,
              bio: data.data.twitter_data.user.description,
              location: data.data.twitter_data.user.location,
              verified: data.data.twitter_data.user.verified,
              engagementRate: Math.round(Math.random() * 10 + 5),
              interests: data.data.topics || ['technology', 'product'],
              recentTweets: data.data.twitter_data.tweets.map(t => t.text)
            },
            simulation: {
              dialogues: mockDialogues
            },
            elevenlabs_analysis: {
              audioFiles: data.data.audio?.hasAudio ? ['mock_audio_1.mp3', 'mock_audio_2.mp3'] : []
            },
            crossmint_analysis: {
              nftMetadata: {
                title: `InsightPilot Analysis - ${data.data.user.username}`,
                description: `User analysis NFT for ${data.data.user.product_description}`
              }
            }
          }
        }
        
        setResult(formattedData)
      }, 11000)
      
    } catch (error) {
      console.error('‚ùå APIË∞ÉÁî®Â§±Ë¥•:', error)
      alert(`Analysis failed: ${error.message}`)
      setIsAnalyzing(false)
      setIsShowingDialogue(false)
      setCurrentStep('')
      setProgress(0)
    }
  }

  // ÈáçÁΩÆË°®Âçï
  const resetForm = () => {
    setInputType('link')
    setUsername('')
    setUserPosts('')
    setProductDescription('')
    setIsAnalyzing(false)
    setProgress(0)
    setCurrentStep('')
    setSimulationDialogues([])
    setCurrentDialogueIndex(0)
    setIsShowingDialogue(false)
    setAgentOutputs({})
    setResult(null)
  }

  return (
    <div style={{ 
      padding: '20px', 
      maxWidth: '1400px', 
      margin: '0 auto',
      fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",
      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      minHeight: '100vh',
      position: 'relative',
      overflow: 'auto'
    }}>
      {/* ËÉåÊôØË£ÖÈ•∞ */}
      <div style={{
        position: 'absolute',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        background: `
          radial-gradient(circle at 20% 80%, rgba(255, 119, 48, 0.3) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(255, 193, 7, 0.3) 0%, transparent 50%),
          radial-gradient(circle at 40% 40%, rgba(255, 87, 34, 0.2) 0%, transparent 50%)
        `,
        pointerEvents: 'none'
      }} />
      
      {/* Ê†áÈ¢ò */}
      <div style={{ 
        textAlign: 'center', 
        marginBottom: '50px',
        position: 'relative',
        zIndex: 1
      }}>
        <div style={{
          background: 'rgba(255, 255, 255, 0.1)',
          backdropFilter: 'blur(20px)',
          borderRadius: '30px',
          padding: '40px',
          border: '1px solid rgba(255, 255, 255, 0.2)',
          boxShadow: '0 25px 50px rgba(0, 0, 0, 0.1)',
          transform: 'perspective(1000px) rotateX(5deg)',
          marginBottom: '20px'
        }}>
          <h1 style={{ 
            background: 'linear-gradient(45deg, #ff6b35, #f7931e, #ffd700)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            fontSize: '4rem', 
            marginBottom: '15px',
            fontWeight: '900',
            textShadow: '0 0 30px rgba(255, 107, 53, 0.5)',
            letterSpacing: '-0.02em',
            fontFamily: "'Space Grotesk', sans-serif"
          }}>
            üöÄ InsightPilot
          </h1>
          <p style={{ 
            color: 'rgba(255, 255, 255, 0.9)', 
            fontSize: '1.4rem',
            margin: 0,
            fontWeight: '500',
            textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)'
          }}>
            ‚ú® AI-Powered User Insight Analysis Platform
          </p>
        </div>
      </div>
      
      {/* Êô∫ËÉΩÂàÜÊûêË°®Âçï */}
      <div style={{ 
        background: 'rgba(255, 255, 255, 0.95)',
        backdropFilter: 'blur(20px)',
        padding: '40px', 
        borderRadius: '25px', 
        boxShadow: '0 30px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.2)',
        marginBottom: '40px',
        position: 'relative',
        zIndex: 1,
        border: '1px solid rgba(255, 255, 255, 0.3)',
        transform: 'perspective(1000px) rotateX(2deg)',
        transition: 'all 0.3s ease'
      }}>
        <form onSubmit={handleSmartAnalysis}>
          <div style={{ textAlign: 'center', marginBottom: '30px' }}>
            <label style={{ 
              display: 'block', 
              marginBottom: '20px', 
              fontWeight: '700',
              fontSize: '1.6rem',
              background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              textAlign: 'center'
            }}>
              üéØ Smart Analysis Input
            </label>
          </div>
          
          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: '1fr 1fr', 
            gap: '30px',
            marginBottom: '30px'
          }}>
            {/* XÁî®Êà∑ÂêçËæìÂÖ• */}
            <div>
              <label style={{ 
                display: 'block', 
                marginBottom: '15px', 
                fontWeight: '700',
                fontSize: '1.1rem',
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent'
              }}>
                üë§ X Username
              </label>
              <input
                type="text"
                value={username}
                onChange={(e) => setUsername(e.target.value)}
                placeholder="X Username"
                style={{
                  width: '100%',
                  padding: '20px',
                  border: '3px solid rgba(255, 107, 53, 0.3)',
                  borderRadius: '20px',
                  fontSize: '1.1rem',
                  transition: 'all 0.3s ease',
                  outline: 'none',
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                  fontWeight: '500'
                }}
                disabled={isAnalyzing}
                onFocus={(e) => {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'translateY(-2px)'
                }}
                onBlur={(e) => {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'translateY(0)'
                }}
              />
            </div>

            {/* ‰∫ßÂìÅÂêçËæìÂÖ• */}
            <div>
              <label style={{ 
                display: 'block', 
                marginBottom: '15px', 
                fontWeight: '700',
                fontSize: '1.1rem',
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent'
              }}>
                üéØ Product Name
              </label>
              <input
                type="text"
                value={productDescription}
                onChange={(e) => setProductDescription(e.target.value)}
                placeholder="Product Description"
                style={{
                  width: '100%',
                  padding: '20px',
                  border: '3px solid rgba(255, 107, 53, 0.3)',
                  borderRadius: '20px',
                  fontSize: '1.1rem',
                  transition: 'all 0.3s ease',
                  outline: 'none',
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                  fontWeight: '500'
                }}
                disabled={isAnalyzing}
                onFocus={(e) => {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'translateY(-2px)'
                }}
                onBlur={(e) => {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'translateY(0)'
                }}
              />
            </div>
          </div>
          
          {/* Êèê‰∫§ÊåâÈíÆ */}
          <div style={{ 
            display: 'flex', 
            gap: '20px',
            justifyContent: 'center',
            marginTop: '20px'
          }}>
            <button
              type="submit"
              disabled={isAnalyzing || !username.trim() || !productDescription.trim()}
              style={{
                flex: 1,
                maxWidth: '300px',
                padding: '20px 40px',
                borderRadius: '25px',
                border: 'none',
                background: isAnalyzing 
                  ? 'linear-gradient(135deg, #9ca3af, #6b7280)' 
                  : 'linear-gradient(135deg, #ff6b35, #f7931e, #ffd700)',
                color: 'white',
                fontSize: '1.3rem',
                fontWeight: '700',
                cursor: isAnalyzing ? 'not-allowed' : 'pointer',
                transition: 'all 0.3s ease',
                boxShadow: isAnalyzing 
                  ? 'none' 
                  : '0 20px 40px rgba(255, 107, 53, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
                transform: isAnalyzing ? 'none' : 'perspective(1000px) rotateX(5deg)',
                textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)',
                letterSpacing: '0.5px',
                position: 'relative',
                overflow: 'hidden'
              }}
              onMouseEnter={(e) => {
                if (!isAnalyzing) {
                  e.target.style.transform = 'perspective(1000px) rotateX(8deg) scale(1.05)'
                  e.target.style.boxShadow = '0 25px 50px rgba(255, 107, 53, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.3)'
                }
              }}
              onMouseLeave={(e) => {
                if (!isAnalyzing) {
                  e.target.style.transform = 'perspective(1000px) rotateX(5deg) scale(1)'
                  e.target.style.boxShadow = '0 20px 40px rgba(255, 107, 53, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                }
              }}
            >
              {isAnalyzing ? 'üîÑ Analyzing...' : 'üöÄ Start Smart Analysis'}
            </button>
            
            <button
              type="button"
              onClick={resetForm}
              disabled={isAnalyzing}
              style={{
                padding: '20px 30px',
                borderRadius: '25px',
                border: '3px solid rgba(255, 107, 53, 0.3)',
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                color: '#ff6b35',
                fontSize: '1.1rem',
                fontWeight: '600',
                cursor: isAnalyzing ? 'not-allowed' : 'pointer',
                transition: 'all 0.3s ease',
                boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                transform: 'perspective(1000px) rotateX(3deg)'
              }}
              onMouseEnter={(e) => {
                if (!isAnalyzing) {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'perspective(1000px) rotateX(5deg) scale(1.05)'
                }
              }}
              onMouseLeave={(e) => {
                if (!isAnalyzing) {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'perspective(1000px) rotateX(3deg) scale(1)'
                }
              }}
            >
              üîÑ Reset
            </button>
          </div>
        </form>
      </div>

      {/* ÈöêËóèÁöÑ‰∏ªË°®Âçï - ‰øùÁïô‰ΩÜ‰∏çÊòæÁ§∫ */}
      <div style={{ 
        display: 'none', // ÈöêËóè‰ΩÜ‰øùÁïô‰ª£Á†Å
        background: 'rgba(255, 255, 255, 0.95)',
        backdropFilter: 'blur(20px)',
        padding: '40px', 
        borderRadius: '25px', 
        boxShadow: '0 30px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.2)',
        marginBottom: '40px',
        position: 'relative',
        zIndex: 1,
        border: '1px solid rgba(255, 255, 255, 0.3)',
        transform: 'perspective(1000px) rotateX(2deg)',
        transition: 'all 0.3s ease'
      }}>
        <form onSubmit={handleSubmit}>
          {/* ËæìÂÖ•ÊñπÂºèÈÄâÊã© */}
          <div style={{ marginBottom: '30px' }}>
            <label style={{ 
              display: 'block', 
              marginBottom: '20px', 
              fontWeight: '700',
              fontSize: '1.3rem',
              background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              textAlign: 'center'
            }}>
              üéØ Select Input Method
            </label>
            <div style={{ 
              display: 'flex', 
              gap: '20px', 
              marginBottom: '25px',
              justifyContent: 'center'
            }}>
              <label style={{ 
                display: 'flex', 
                alignItems: 'center', 
                gap: '15px', 
                padding: '20px 30px', 
                border: `3px solid ${inputType === 'link' ? '#ff6b35' : 'rgba(255, 107, 53, 0.3)'}`,
                borderRadius: '20px',
                cursor: 'pointer',
                background: inputType === 'link' 
                  ? 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))' 
                  : 'rgba(255, 255, 255, 0.8)',
                transition: 'all 0.3s ease',
                fontSize: '1.1rem',
                fontWeight: '600',
                boxShadow: inputType === 'link' 
                  ? '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)' 
                  : '0 8px 25px rgba(0, 0, 0, 0.1)',
                transform: inputType === 'link' ? 'translateY(-2px) scale(1.02)' : 'translateY(0)',
                backdropFilter: 'blur(10px)'
              }}>
                <input
                  type="radio"
                  value="link"
                  checked={inputType === 'link'}
                  onChange={(e) => setInputType(e.target.value)}
                  style={{ 
                    margin: 0, 
                    transform: 'scale(1.5)',
                    accentColor: '#ff6b35'
                  }}
                  disabled={isAnalyzing}
                />
                <span style={{
                  background: inputType === 'link' 
                    ? 'linear-gradient(45deg, #ff6b35, #f7931e)' 
                    : 'linear-gradient(45deg, #666, #999)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem'
                }}>
                  üîó X Link
                </span>
              </label>
              <label style={{ 
                display: 'flex', 
                alignItems: 'center', 
                gap: '15px', 
                padding: '20px 30px', 
                border: `3px solid ${inputType === 'posts' ? '#ff6b35' : 'rgba(255, 107, 53, 0.3)'}`,
                borderRadius: '20px',
                cursor: 'pointer',
                background: inputType === 'posts' 
                  ? 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))' 
                  : 'rgba(255, 255, 255, 0.8)',
                transition: 'all 0.3s ease',
                fontSize: '1.1rem',
                fontWeight: '600',
                boxShadow: inputType === 'posts' 
                  ? '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)' 
                  : '0 8px 25px rgba(0, 0, 0, 0.1)',
                transform: inputType === 'posts' ? 'translateY(-2px) scale(1.02)' : 'translateY(0)',
                backdropFilter: 'blur(10px)'
              }}>
                <input
                  type="radio"
                  value="posts"
                  checked={inputType === 'posts'}
                  onChange={(e) => setInputType(e.target.value)}
                  style={{ 
                    margin: 0, 
                    transform: 'scale(1.5)',
                    accentColor: '#ff6b35'
                  }}
                  disabled={isAnalyzing}
                />
                <span style={{
                  background: inputType === 'posts' 
                    ? 'linear-gradient(45deg, #ff6b35, #f7931e)' 
                    : 'linear-gradient(45deg, #666, #999)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem'
                }}>
                  üìù User Posts
                </span>
              </label>
            </div>
          </div>

          {/* Ê†πÊçÆÈÄâÊã©ÊòæÁ§∫‰∏çÂêåÁöÑËæìÂÖ•Ê°Ü */}
          {inputType === 'link' ? (
            <div style={{ marginBottom: '30px' }}>
              <label style={{ 
                display: 'block', 
                marginBottom: '15px', 
                fontWeight: '700',
                fontSize: '1.1rem',
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent'
              }}>
                üîó X Username or Link
              </label>
              <input
                type="text"
                value={username}
                onChange={(e) => setUsername(e.target.value)}
                placeholder="Enter username (e.g., @tim_cook) or full link (e.g., https://x.com/tim_cook)"
                style={{
                  width: '100%',
                  padding: '20px',
                  border: '3px solid rgba(255, 107, 53, 0.3)',
                  borderRadius: '20px',
                  fontSize: '1.1rem',
                  transition: 'all 0.3s ease',
                  outline: 'none',
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                  fontWeight: '500'
                }}
                disabled={isAnalyzing}
                onFocus={(e) => {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'translateY(-2px)'
                }}
                onBlur={(e) => {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'translateY(0)'
                }}
              />
            </div>
          ) : (
            <div style={{ marginBottom: '30px' }}>
              <label style={{ 
                display: 'block', 
                marginBottom: '15px', 
                fontWeight: '700',
                fontSize: '1.1rem',
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent'
              }}>
                üìù User Post Content
              </label>
              <textarea
                value={userPosts}
                onChange={(e) => setUserPosts(e.target.value)}
                placeholder="Paste user's tweet content, can include multiple tweets..."
                rows={5}
                style={{
                  width: '100%',
                  padding: '20px',
                  border: '3px solid rgba(255, 107, 53, 0.3)',
                  borderRadius: '20px',
                  fontSize: '1.1rem',
                  resize: 'vertical',
                  transition: 'all 0.3s ease',
                  outline: 'none',
                  fontFamily: 'inherit',
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                  fontWeight: '500'
                }}
                disabled={isAnalyzing}
                onFocus={(e) => {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'translateY(-2px)'
                }}
                onBlur={(e) => {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'translateY(0)'
                }}
              />
            </div>
          )}

          <div style={{ marginBottom: '30px' }}>
            <label style={{ 
              display: 'block', 
              marginBottom: '15px', 
              fontWeight: '700',
              fontSize: '1.1rem',
              background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent'
            }}>
              üéØ Product Description
            </label>
            <input
              type="text"
              value={productDescription}
              onChange={(e) => setProductDescription(e.target.value)}
              placeholder="Enter product description"
              style={{
                width: '100%',
                padding: '20px',
                border: '3px solid rgba(255, 107, 53, 0.3)',
                borderRadius: '20px',
                fontSize: '1.1rem',
                transition: 'all 0.3s ease',
                outline: 'none',
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                fontWeight: '500'
              }}
              disabled={isAnalyzing}
              onFocus={(e) => {
                e.target.style.borderColor = '#ff6b35'
                e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                e.target.style.transform = 'translateY(-2px)'
              }}
              onBlur={(e) => {
                e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                e.target.style.transform = 'translateY(0)'
              }}
            />
          </div>
          
          {/* ÊåâÈíÆÁªÑ */}
          <div style={{ 
            display: 'flex', 
            gap: '20px',
            justifyContent: 'center',
            marginTop: '20px'
          }}>
            <button
              type="submit"
              disabled={isAnalyzing || (!username && !userPosts) || !productDescription}
              style={{
                flex: 1,
                maxWidth: '300px',
                padding: '20px 40px',
                borderRadius: '25px',
                border: 'none',
                background: isAnalyzing 
                  ? 'linear-gradient(135deg, #9ca3af, #6b7280)' 
                  : 'linear-gradient(135deg, #ff6b35, #f7931e, #ffd700)',
                color: 'white',
                fontSize: '1.3rem',
                fontWeight: '700',
                cursor: isAnalyzing ? 'not-allowed' : 'pointer',
                transition: 'all 0.3s ease',
                boxShadow: isAnalyzing 
                  ? 'none' 
                  : '0 20px 40px rgba(255, 107, 53, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
                transform: isAnalyzing ? 'none' : 'perspective(1000px) rotateX(5deg)',
                textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)',
                letterSpacing: '0.5px',
                position: 'relative',
                overflow: 'hidden'
              }}
              onMouseEnter={(e) => {
                if (!isAnalyzing) {
                  e.target.style.transform = 'perspective(1000px) rotateX(8deg) scale(1.05)'
                  e.target.style.boxShadow = '0 25px 50px rgba(255, 107, 53, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.3)'
                }
              }}
              onMouseLeave={(e) => {
                if (!isAnalyzing) {
                  e.target.style.transform = 'perspective(1000px) rotateX(5deg) scale(1)'
                  e.target.style.boxShadow = '0 20px 40px rgba(255, 107, 53, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                }
              }}
            >
              {isAnalyzing ? 'üîÑ Analyzing...' : 'üöÄ Start Analysis'}
            </button>
            
            <button
              type="button"
              onClick={resetForm}
              disabled={isAnalyzing}
              style={{
                padding: '20px 30px',
                borderRadius: '25px',
                border: '3px solid rgba(255, 107, 53, 0.3)',
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                color: '#ff6b35',
                fontSize: '1.1rem',
                fontWeight: '600',
                cursor: isAnalyzing ? 'not-allowed' : 'pointer',
                transition: 'all 0.3s ease',
                boxShadow: '0 8px 25px rgba(0, 0, 0, 0.1)',
                transform: 'perspective(1000px) rotateX(3deg)'
              }}
              onMouseEnter={(e) => {
                if (!isAnalyzing) {
                  e.target.style.borderColor = '#ff6b35'
                  e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
                  e.target.style.transform = 'perspective(1000px) rotateX(5deg) scale(1.05)'
                }
              }}
              onMouseLeave={(e) => {
                if (!isAnalyzing) {
                  e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                  e.target.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)'
                  e.target.style.transform = 'perspective(1000px) rotateX(3deg) scale(1)'
                }
              }}
            >
              üîÑ Reset
            </button>
          </div>
        </form>
      </div>

      {/* AI Agent ÂÆûÊó∂ËæìÂá∫Â±ïÁ§∫ */}
      {isAnalyzing && (
        <div style={{ 
          background: 'rgba(255, 255, 255, 0.95)',
          backdropFilter: 'blur(20px)',
          padding: '40px', 
          borderRadius: '25px', 
          boxShadow: '0 30px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.2)',
          marginBottom: '40px',
          position: 'relative',
          zIndex: 1,
          border: '1px solid rgba(255, 255, 255, 0.3)',
          transform: 'perspective(1000px) rotateX(2deg)',
          transition: 'all 0.3s ease'
        }}>
          <h2 style={{ 
            textAlign: 'center', 
            marginBottom: '30px', 
            background: 'linear-gradient(45deg, #ff6b35, #f7931e, #ffd700)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            fontSize: '2rem',
            fontWeight: '800',
            textShadow: '0 0 30px rgba(255, 107, 53, 0.5)',
            letterSpacing: '-0.02em'
          }}>
            ü§ñ AI Agent Real-time Output
          </h2>
          
          {/* ËøõÂ∫¶Êù° */}
          <div style={{ marginBottom: '30px' }}>
            <div style={{
              width: '100%',
              height: '20px',
              backgroundColor: 'rgba(255, 107, 53, 0.2)',
              borderRadius: '15px',
              overflow: 'hidden',
              marginBottom: '15px',
              boxShadow: 'inset 0 2px 10px rgba(0, 0, 0, 0.1)',
              border: '2px solid rgba(255, 107, 53, 0.3)'
            }}>
              <div style={{
                width: `${progress}%`,
                height: '100%',
                background: 'linear-gradient(90deg, #ff6b35, #f7931e, #ffd700)',
                borderRadius: '12px',
                transition: 'width 0.8s ease',
                boxShadow: '0 0 20px rgba(255, 107, 53, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.3)',
                position: 'relative',
                overflow: 'hidden'
              }}>
                <div style={{
                  position: 'absolute',
                  top: 0,
                  left: 0,
                  right: 0,
                  bottom: 0,
                  background: 'linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent)',
                  animation: 'shimmer 2s infinite'
                }} />
              </div>
            </div>
            <div style={{ 
              textAlign: 'center', 
              background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              fontSize: '1.2rem',
              fontWeight: '700',
              textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)'
            }}>
              {progress}% - {currentStep}
            </div>
          </div>
        </div>
      )}

      {/* ÂÆûÊó∂ÂØπËØùÊí≠Êä• */}
      {simulationDialogues.length > 0 && isAnalyzing && (
        <div style={{ 
          background: 'rgba(255, 255, 255, 0.95)',
          backdropFilter: 'blur(20px)',
          padding: '40px', 
          borderRadius: '25px', 
          boxShadow: '0 30px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.2)',
          marginBottom: '40px',
          position: 'relative',
          zIndex: 1,
          border: '1px solid rgba(255, 255, 255, 0.3)',
          transform: 'perspective(1000px) rotateX(2deg)',
          transition: 'all 0.3s ease'
        }}>
          <h2 style={{ 
            textAlign: 'center', 
            marginBottom: '20px', 
            background: 'linear-gradient(45deg, #ff6b35, #f7931e, #ffd700)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            fontSize: '2rem',
            fontWeight: '800',
            textShadow: '0 0 30px rgba(255, 107, 53, 0.5)',
            letterSpacing: '-0.02em'
          }}>
            üé≠ 5 Questions & 5 Answers Live Feed
          </h2>
          
          {/* ‰∏ìÂÆ∂‰ªãÁªç */}
          {simulationDialogues.length > 0 && simulationDialogues[0] && (
            <div style={{
              background: 'linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1))',
              padding: '25px',
              borderRadius: '20px',
              border: '3px solid rgba(102, 126, 234, 0.3)',
              marginBottom: '30px',
              backdropFilter: 'blur(10px)',
              boxShadow: '0 15px 35px rgba(102, 126, 234, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
              transform: 'perspective(1000px) rotateX(2deg)'
            }}>
              <h4 style={{ 
                background: 'linear-gradient(45deg, #667eea, #764ba2)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                marginBottom: '15px',
                fontSize: '1.3rem',
                fontWeight: '700',
                textAlign: 'center'
              }}>
                üíº Product Expert Introduction
              </h4>
              <p style={{ 
                color: '#667eea', 
                lineHeight: '1.8',
                fontSize: '1.2rem',
                margin: 0,
                fontWeight: '600',
                textShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',
                textAlign: 'center',
                fontStyle: 'italic'
              }}>
                "{result?.data?.intro || "Welcome to our product insight interview."}"
              </p>
            </div>
          )}

          <div style={{ 
            display: 'flex', 
            justifyContent: 'space-between', 
            marginBottom: '30px',
            alignItems: 'center'
          }}>
            <h3 style={{ 
              background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              fontSize: '1.4rem', 
              margin: 0,
              fontWeight: '700'
            }}>
              üí¨ Current Dialogue
            </h3>
            <span style={{ 
              background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))',
              color: '#ff6b35',
              fontSize: '1.1rem',
              fontWeight: '600',
              padding: '12px 24px',
              borderRadius: '25px',
              border: '2px solid rgba(255, 107, 53, 0.3)',
              backdropFilter: 'blur(10px)',
              boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
            }}>
              Question {currentDialogueIndex + 1} / {simulationDialogues.length}
            </span>
          </div>

          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: '1fr 1fr', 
            gap: '30px', 
            marginBottom: '30px' 
          }}>
            {/* ‰∫ßÂìÅ‰∏ìÂÆ∂ÈóÆÈ¢ò */}
            <div style={{
              background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))',
              padding: '25px',
              borderRadius: '20px',
              border: '3px solid rgba(255, 107, 53, 0.3)',
              transition: 'all 0.3s ease',
              backdropFilter: 'blur(10px)',
              boxShadow: '0 15px 35px rgba(255, 107, 53, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
              transform: 'perspective(1000px) rotateY(-5deg)'
            }}>
              <h4 style={{ 
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                marginBottom: '20px',
                fontSize: '1.3rem',
                fontWeight: '700'
              }}>
                üíº Product Expert Question
              </h4>
              <p style={{ 
                color: '#ff6b35', 
                lineHeight: '1.8',
                fontSize: '1.4rem',
                margin: 0,
                fontWeight: '700',
                textShadow: '0 2px 6px rgba(0, 0, 0, 0.2)',
                letterSpacing: '0.3px'
              }}>
                {simulationDialogues[currentDialogueIndex]?.question}
              </p>
            </div>

            {/* Ê®°ÊãüÁî®Êà∑ÂõûÁ≠î */}
            <div style={{
              background: 'linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 152, 0, 0.1))',
              padding: '25px',
              borderRadius: '20px',
              border: '3px solid rgba(255, 193, 7, 0.3)',
              transition: 'all 0.3s ease',
              backdropFilter: 'blur(10px)',
              boxShadow: '0 15px 35px rgba(255, 193, 7, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
              transform: 'perspective(1000px) rotateY(5deg)'
            }}>
              <h4 style={{ 
                background: 'linear-gradient(45deg, #ffc107, #ff9800)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                marginBottom: '20px',
                fontSize: '1.3rem',
                fontWeight: '700'
              }}>
                üë§ Simulated User Answer
              </h4>
              <p style={{ 
                color: '#ff9800', 
                lineHeight: '1.8',
                fontSize: '1.4rem',
                margin: 0,
                fontWeight: '700',
                textShadow: '0 2px 6px rgba(0, 0, 0, 0.2)',
                letterSpacing: '0.3px'
              }}>
                {simulationDialogues[currentDialogueIndex]?.answer}
              </p>
            </div>
          </div>

          {/* ÂàÜÊûêÁªìÊûú */}
          <div style={{
            background: 'linear-gradient(135deg, rgba(255, 87, 34, 0.1), rgba(255, 119, 48, 0.1))',
            padding: '25px',
            borderRadius: '20px',
            border: '3px solid rgba(255, 87, 34, 0.3)',
            backdropFilter: 'blur(10px)',
            boxShadow: '0 15px 35px rgba(255, 87, 34, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
            transform: 'perspective(1000px) rotateX(3deg)'
          }}>
            <h4 style={{ 
              background: 'linear-gradient(45deg, #ff5722, #ff7733)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              marginBottom: '20px',
              fontSize: '1.3rem',
              fontWeight: '700'
            }}>
              üß† AI Analysis Result
            </h4>
            <p style={{ 
              color: '#ff5722', 
              lineHeight: '1.8',
              fontSize: '1.4rem',
              margin: 0,
              fontWeight: '700',
              textShadow: '0 2px 6px rgba(0, 0, 0, 0.2)',
              letterSpacing: '0.3px'
            }}>
              {simulationDialogues[currentDialogueIndex]?.analysis}
            </p>
          </div>
        </div>
      )}

      {/* ÁªìÊûúÊòæÁ§∫ */}
      {result && (
        <div style={{
          background: 'rgba(255, 255, 255, 0.95)',
          backdropFilter: 'blur(20px)',
          padding: '40px',
          borderRadius: '25px',
          border: '3px solid rgba(255, 107, 53, 0.3)',
          boxShadow: '0 30px 60px rgba(255, 107, 53, 0.2), 0 0 0 1px rgba(255,255,255,0.2)',
          position: 'relative',
          zIndex: 1,
          transform: 'perspective(1000px) rotateX(2deg)',
          transition: 'all 0.3s ease',
          minHeight: 'auto',
          overflow: 'visible',
          marginBottom: '50px'
        }}>
          <h3 style={{ 
            background: 'linear-gradient(45deg, #ff6b35, #f7931e, #ffd700)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            marginBottom: '30px',
            fontSize: '2.5rem',
            fontWeight: '800',
            textAlign: 'center',
            textShadow: '0 0 30px rgba(255, 107, 53, 0.5)',
            letterSpacing: '-0.02em'
          }}>
            ‚úÖ Analysis Complete
          </h3>
          
          {/* ‰∏ãËΩΩÊåâÈíÆÁªÑ */}
          <div style={{ 
            display: 'flex', 
            gap: '20px', 
            justifyContent: 'center',
            marginBottom: '30px',
            flexWrap: 'wrap'
          }}>
            <button
              onClick={() => downloadReport(result)}
              style={{
                padding: '15px 30px',
                borderRadius: '20px',
                border: 'none',
                background: 'linear-gradient(135deg, #ff6b35, #f7931e)',
                color: 'white',
                fontSize: '1.1rem',
                fontWeight: '600',
                cursor: 'pointer',
                transition: 'all 0.3s ease',
                boxShadow: '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)',
                transform: 'perspective(1000px) rotateX(5deg)',
                textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)',
                letterSpacing: '0.5px'
              }}
              onMouseEnter={(e) => {
                e.target.style.transform = 'perspective(1000px) rotateX(8deg) scale(1.05)'
                e.target.style.boxShadow = '0 20px 40px rgba(255, 107, 53, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3)'
              }}
              onMouseLeave={(e) => {
                e.target.style.transform = 'perspective(1000px) rotateX(5deg) scale(1)'
                e.target.style.boxShadow = '0 15px 35px rgba(255, 107, 53, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2)'
              }}
            >
              üìÑ Download User Report
            </button>
            
          </div>
          <div style={{ fontSize: '1.1rem', lineHeight: '1.7' }}>
            <div style={{ 
              display: 'grid', 
              gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', 
              gap: '20px',
              marginBottom: '30px'
            }}>
              <div style={{
                background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))',
                padding: '20px',
                borderRadius: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
              }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem',
                  fontWeight: '700'
                }}>
                  üë§ User:
                </strong>
                <p style={{ margin: '8px 0', color: '#ff6b35', fontWeight: '600' }}>{result.data.user}</p>
              </div>
              <div style={{
                background: 'linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 152, 0, 0.1))',
                padding: '20px',
                borderRadius: '15px',
                border: '2px solid rgba(255, 193, 7, 0.3)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 8px 25px rgba(255, 193, 7, 0.2)'
              }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ffc107, #ff9800)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem',
                  fontWeight: '700'
                }}>
                  üéØ Product:
                </strong>
                <p style={{ margin: '8px 0', color: '#ff9800', fontWeight: '600' }}>{result.data.product}</p>
              </div>
              <div style={{
                background: 'linear-gradient(135deg, rgba(255, 87, 34, 0.1), rgba(255, 119, 48, 0.1))',
                padding: '20px',
                borderRadius: '15px',
                border: '2px solid rgba(255, 87, 34, 0.3)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 8px 25px rgba(255, 87, 34, 0.2)'
              }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ff5722, #ff7733)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem',
                  fontWeight: '700'
                }}>
                  üìä Collected tweet count:
                </strong>
                <p style={{ margin: '8px 0', color: '#ff5722', fontWeight: '600' }}>{result.data.twitter_analysis.recentTweets.length}</p>
              </div>
              <div style={{
                background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))',
                padding: '20px',
                borderRadius: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
              }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.2rem',
                  fontWeight: '700'
                }}>
                  ‚è∞ Analysis Time:
                </strong>
                <p style={{ margin: '8px 0', color: '#ff6b35', fontWeight: '600' }}>{new Date(result.data.analysisDate).toLocaleString()}</p>
              </div>
            </div>
            
            <div>
              <strong style={{ 
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                fontSize: '1.4rem',
                fontWeight: '700'
              }}>
                üìù Recent Tweets:
              </strong>
              <div style={{ 
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                padding: '20px',
                borderRadius: '15px',
                marginTop: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
              }}>
                {result.data.twitter_analysis.recentTweets.map((tweet, index) => (
                  <div key={index} style={{ 
                    marginBottom: '12px', 
                    fontSize: '1rem',
                    color: '#ff6b35',
                    padding: '15px',
                    background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.05), rgba(247, 147, 30, 0.05))',
                    borderRadius: '12px',
                    border: '1px solid rgba(255, 107, 53, 0.2)',
                    fontWeight: '500',
                    lineHeight: '1.6',
                    boxShadow: '0 4px 15px rgba(255, 107, 53, 0.1)'
                  }}>
                    {tweet}
                  </div>
                ))}
              </div>
            </div>
            
            {/* 5‰∏™ÈóÆÁ≠îÂ±ïÁ§∫Âå∫Âüü */}
            <div style={{ marginTop: '30px' }}>
              <strong style={{ 
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                fontSize: '1.4rem',
                fontWeight: '700'
              }}>
                üí¨ 5 Questions & 5 Answers:
              </strong>
              <div style={{ 
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                padding: '20px',
                borderRadius: '15px',
                marginTop: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
              }}>
                {result.data.simulation.dialogues.map((dialogue, index) => (
                  <div key={index} style={{ 
                    marginBottom: '20px',
                    padding: '20px',
                    background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.05), rgba(247, 147, 30, 0.05))',
                    borderRadius: '15px',
                    border: '2px solid rgba(255, 107, 53, 0.2)',
                    boxShadow: '0 4px 15px rgba(255, 107, 53, 0.1)'
                  }}>
                    <div style={{ 
                      display: 'flex', 
                      alignItems: 'center', 
                      marginBottom: '15px',
                      gap: '10px'
                    }}>
                      <div style={{
                        background: 'linear-gradient(135deg, #ff6b35, #f7931e)',
                        color: 'white',
                        padding: '8px 16px',
                        borderRadius: '20px',
                        fontSize: '0.9rem',
                        fontWeight: '600',
                        boxShadow: '0 4px 15px rgba(255, 107, 53, 0.3)'
                      }}>
                        Question {index + 1}
                      </div>
                    </div>
                    
                    <div style={{ 
                      display: 'grid', 
                      gridTemplateColumns: '1fr 1fr', 
                      gap: '20px',
                      marginBottom: '15px'
                    }}>
                      {/* ÈóÆÈ¢ò */}
                      <div style={{
                        background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1))',
                        padding: '15px',
                        borderRadius: '12px',
                        border: '2px solid rgba(255, 107, 53, 0.3)',
                        backdropFilter: 'blur(10px)'
                      }}>
                        <h4 style={{ 
                          background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                          WebkitBackgroundClip: 'text',
                          WebkitTextFillColor: 'transparent',
                          marginBottom: '10px',
                          fontSize: '1.1rem',
                          fontWeight: '700'
                        }}>
                          üíº Product Expert Question
                        </h4>
                        <p style={{ 
                          color: '#ff6b35', 
                          lineHeight: '1.6',
                          fontSize: '1rem',
                          margin: 0,
                          fontWeight: '500'
                        }}>
                          {dialogue.question}
                        </p>
                      </div>

                      {/* ÂõûÁ≠î */}
                      <div style={{
                        background: 'linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 152, 0, 0.1))',
                        padding: '15px',
                        borderRadius: '12px',
                        border: '2px solid rgba(255, 193, 7, 0.3)',
                        backdropFilter: 'blur(10px)'
                      }}>
                        <h4 style={{ 
                          background: 'linear-gradient(45deg, #ffc107, #ff9800)',
                          WebkitBackgroundClip: 'text',
                          WebkitTextFillColor: 'transparent',
                          marginBottom: '10px',
                          fontSize: '1.1rem',
                          fontWeight: '700'
                        }}>
                          üë§ Simulated User Answer
                        </h4>
                        <p style={{ 
                          color: '#ff9800', 
                          lineHeight: '1.6',
                          fontSize: '1rem',
                          margin: 0,
                          fontWeight: '500'
                        }}>
                          {dialogue.answer}
                        </p>
                      </div>
                    </div>

                    {/* ÂàÜÊûêÁªìÊûú */}
                    <div style={{
                      background: 'linear-gradient(135deg, rgba(255, 87, 34, 0.1), rgba(255, 119, 48, 0.1))',
                      padding: '15px',
                      borderRadius: '12px',
                      border: '2px solid rgba(255, 87, 34, 0.3)',
                      backdropFilter: 'blur(10px)'
                    }}>
                      <h4 style={{ 
                        background: 'linear-gradient(45deg, #ff5722, #ff7733)',
                        WebkitBackgroundClip: 'text',
                        WebkitTextFillColor: 'transparent',
                        marginBottom: '10px',
                        fontSize: '1.1rem',
                        fontWeight: '700'
                      }}>
                        üß† AI Analysis Result
                      </h4>
                      <p style={{ 
                        color: '#ff5722', 
                        lineHeight: '1.6',
                        fontSize: '1rem',
                        margin: 0,
                        fontWeight: '500'
                      }}>
                        {dialogue.analysis}
                      </p>
                    </div>
                  </div>
                ))}
              </div>
            </div>


            {/* AIÂàÜÊûêÁªìÊûúÂå∫Âüü */}
            {result.data.ai_analysis && (
              <div style={{ marginTop: '30px' }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.4rem',
                  fontWeight: '700'
                }}>
                  üß† AI Analysis Result:
                </strong>
                <div style={{ 
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  padding: '20px',
                  borderRadius: '15px',
                  marginTop: '15px',
                  border: '2px solid rgba(255, 107, 53, 0.3)',
                  boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
                }}>
                  <div style={{ 
                    display: 'grid', 
                    gridTemplateColumns: '1fr', 
                    gap: '20px'
                  }}>
                    <div>
                      <div style={{ color: '#ff6b35', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üéØ Persona</div>
                      <p style={{ color: '#ff6b35', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.ai_analysis.persona}
                      </p>
                    </div>
                    <div>
                      <div style={{ color: '#ff9800', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üí° Opportunities</div>
                      <p style={{ color: '#ff9800', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.ai_analysis.opportunities}
                      </p>
                    </div>
                    <div>
                      <div style={{ color: '#ff5722', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>‚ö†Ô∏è Risks</div>
                      <p style={{ color: '#ff5722', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.ai_analysis.risks}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            )}


            {/* Ëê•ÈîÄÁ≠ñÁï•Âª∫ËÆÆÂå∫Âüü */}
            {result.data.marketing_strategy && (
              <div style={{ marginTop: '30px', marginBottom: '30px' }}>
                <strong style={{ 
                  background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                  fontSize: '1.4rem',
                  fontWeight: '700'
                }}>
                  üìà Marketing Strategy Suggestions:
                </strong>
                <div style={{ 
                  background: 'rgba(255, 255, 255, 0.9)',
                  backdropFilter: 'blur(10px)',
                  padding: '20px',
                  borderRadius: '15px',
                  marginTop: '15px',
                  border: '2px solid rgba(255, 107, 53, 0.3)',
                  boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)',
                  minHeight: 'auto',
                  overflow: 'visible'
                }}>
                  <div style={{ 
                    display: 'grid', 
                    gridTemplateColumns: '1fr', 
                    gap: '20px',
                    minHeight: 'auto'
                  }}>
                    <div>
                      <div style={{ color: '#ff6b35', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üéØ Target Positioning</div>
                      <p style={{ color: '#ff6b35', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.marketing_strategy.targetPositioning}
                      </p>
                    </div>
                    <div>
                      <div style={{ color: '#ff9800', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üì± Marketing Channels</div>
                      <p style={{ color: '#ff9800', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.marketing_strategy.marketingChannels}
                      </p>
                    </div>
                    <div>
                      <div style={{ color: '#ff5722', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üí∞ Pricing Strategy</div>
                      <p style={{ color: '#ff5722', fontSize: '1rem', lineHeight: '1.6', margin: 0 }}>
                        {result.data.marketing_strategy.pricingStrategy}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* ÊóßÁöÑËê•ÈîÄÁ≠ñÁï•Âª∫ËÆÆÂå∫Âüü - ‰øùÊåÅÂêëÂêéÂÖºÂÆπ */}
            <div style={{ marginTop: '30px', display: result.data.marketing_strategy ? 'none' : 'block' }}>
              <strong style={{ 
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                fontSize: '1.4rem',
                fontWeight: '700'
              }}>
                üìà Marketing Strategy Suggestions:
              </strong>
              <div style={{ 
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                padding: '20px',
                borderRadius: '15px',
                marginTop: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)'
              }}>
                <div style={{ 
                  display: 'grid', 
                  gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', 
                  gap: '20px'
                }}>
                  <div>
                    <div style={{ color: '#ff6b35', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üéØ ÁõÆÊ†áÂÆö‰Ωç</div>
                    <ul style={{ color: '#ff6b35', fontSize: '0.9rem', lineHeight: '1.6', margin: 0, paddingLeft: '20px' }}>
                      <li>ÊäÄÊúØÁà±Â•ΩËÄÖÁæ§‰Ωì</li>
                      <li>ËøΩÊ±ÇÊïàÁéáÁöÑÁî®Êà∑</li>
                      <li>‰ª∑Ê†ºÊïèÊÑü‰ΩÜÈáçËßÜÂìÅË¥®</li>
                    </ul>
                  </div>
                  <div>
                    <div style={{ color: '#ff9800', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üì± Ëê•ÈîÄÊ∏†ÈÅì</div>
                    <ul style={{ color: '#ff9800', fontSize: '0.9rem', lineHeight: '1.6', margin: 0, paddingLeft: '20px' }}>
                      <li>Twitter/XÂπ≥Âè∞ÈáçÁÇπÊé®Âπø</li>
                      <li>ÊäÄÊúØÁ±ªKOLÂêà‰Ωú</li>
                      <li>ÂàõÊñ∞ÊäÄÊúØÂÜÖÂÆπËê•ÈîÄ</li>
                    </ul>
                  </div>
                  <div>
                    <div style={{ color: '#ff5722', fontWeight: '600', marginBottom: '10px', fontSize: '1.1rem' }}>üí∞ ‰ª∑Ê†ºÁ≠ñÁï•</div>
                    <ul style={{ color: '#ff5722', fontSize: '0.9rem', lineHeight: '1.6', margin: 0, paddingLeft: '20px' }}>
                      <li>Êèê‰æõÂàÜÊúü‰ªòÊ¨æÈÄâÈ°π</li>
                      <li>ÁßüËµÅÊúçÂä°Ê®°Âºè</li>
                      <li>ÈÄèÊòé‰ª∑Ê†ºÁªìÊûÑ</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            {/* ElevenLabs ËØ≠Èü≥Êä•ÂëäÂå∫Âüü */}
            <div style={{ marginTop: '30px', marginBottom: '30px' }}>
              <strong style={{ 
                background: 'linear-gradient(45deg, #ff6b35, #f7931e)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                fontSize: '1.4rem',
                fontWeight: '700'
              }}>
                üéµ ElevenLabs Voice Report:
              </strong>
              <div style={{ 
                background: 'rgba(255, 255, 255, 0.9)',
                backdropFilter: 'blur(10px)',
                padding: '20px',
                borderRadius: '15px',
                marginTop: '15px',
                border: '2px solid rgba(255, 107, 53, 0.3)',
                boxShadow: '0 8px 25px rgba(255, 107, 53, 0.2)',
                minHeight: 'auto',
                overflow: 'visible'
              }}>
                <div style={{ 
                  marginBottom: '15px',
                  padding: '15px',
                  background: 'linear-gradient(135deg, rgba(255, 107, 53, 0.05), rgba(247, 147, 30, 0.05))',
                  borderRadius: '12px',
                  border: '1px solid rgba(255, 107, 53, 0.2)',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '15px',
                  flexWrap: 'wrap'
                }}>
                  <div style={{ flex: 1 }}>
                    <div style={{ 
                      color: '#ff6b35', 
                      fontWeight: '600',
                      marginBottom: '8px',
                      fontSize: '1rem'
                    }}>
                      üìä User Analysis Report (Audio)
                    </div>
                    <div style={{ 
                      color: '#666', 
                      fontSize: '0.9rem',
                      marginBottom: '10px'
                    }}>
                      Complete user insight analysis converted to speech format - ready for download
                    </div>
                    <audio 
                      controls 
                      style={{ 
                        width: '100%',
                        maxWidth: '300px',
                        height: '40px',
                        borderRadius: '8px',
                        marginTop: '10px'
                      }}
                    >
                      <source 
                        src="/Elon_Musk_Apple.m4a" 
                        type="audio/mp4" 
                      />
                      Your browser does not support audio playback
                    </audio>
                  </div>
                  <button
                    onClick={() => {
                      // ‰∏ãËΩΩÁúüÂÆûÁöÑÈü≥È¢ëÊñá‰ª∂
                      const link = document.createElement('a');
                      link.href = '/Elon_Musk_Apple.m4a';
                      link.download = `InsightPilot_Voice_Report_${result.data.user || 'user'}_${new Date().toISOString().split('T')[0]}.m4a`;
                      document.body.appendChild(link);
                      link.click();
                      document.body.removeChild(link);
                    }}
                    style={{
                      padding: '8px 16px',
                      borderRadius: '12px',
                      border: '2px solid rgba(255, 107, 53, 0.3)',
                      background: 'rgba(255, 107, 53, 0.1)',
                      color: '#ff6b35',
                      fontSize: '0.9rem',
                      fontWeight: '600',
                      cursor: 'pointer',
                      transition: 'all 0.3s ease',
                      whiteSpace: 'nowrap'
                    }}
                    onMouseEnter={(e) => {
                      e.target.style.background = 'rgba(255, 107, 53, 0.2)'
                      e.target.style.borderColor = '#ff6b35'
                    }}
                    onMouseLeave={(e) => {
                      e.target.style.background = 'rgba(255, 107, 53, 0.1)'
                      e.target.style.borderColor = 'rgba(255, 107, 53, 0.3)'
                    }}
                  >
                    üì• Download Audio Report
                  </button>
                </div>
                <div style={{ 
                  color: '#666', 
                  fontSize: '0.9rem',
                  fontStyle: 'italic',
                  textAlign: 'center',
                  marginTop: '10px'
                }}>
                  * This is a sample audio file. In production, this would contain the actual voice synthesis of the user analysis report.
                </div>
              </div>
            </div>

          </div>
        </div>
      )}
    </div>
  )
}

export default App
